(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[113],{"1aMd":function(e,t,a){"use strict";var i=a("E+oP"),r=a.n(i),s=a("Z0cm"),n=a.n(s),o=a("mwIZ"),l=a.n(o),c=a("DzJC"),d=a.n(c),p=a("iRAd"),m=a("TUVh"),u=a("gnvm"),h=a("QqFe"),f=a("q1tI"),b=a.n(f),v=a("24Ii"),_=a.n(v),g=a("xk4V"),E=a.n(g),S=a("TSYQ"),y=a.n(S),C=a("gtj7"),k=a("ev9x"),N=a("b0K7"),F=a("z9go"),j=a("tYyt"),O=a("hFGM"),I=a("NWss"),R=a("f0Wu"),V=a.n(R),x=a("DAui"),w=a("f8p9"),P=a("oHca"),B=a("1wI6"),U=a("5sab"),z=a("ANOs"),D="validationText__2V8IomQ7py3ImJSkR74lUL",G="tooltip__SfXUpCRO-J9ns7jIIcq-2",L="tipWrapper__2EqLYLfvCkkov8Czpsfpvc",A="tooltipTarget__2QEgWo1UnUfrI64N8g5a7R",q="infoIcon__1g_zfaxGIRIbEh291YxmGv",T="tooltipContents__2bqd9NtbRxq1kYIR2tCLhZ";const W={password:z.a};var Q=e=>{if(!e.validationError)return null;const t=W[e.fieldName];return t?b.a.createElement("div",{className:G},b.a.createElement(P.a,{focusable:!0,id:`${e.fieldName}-tooltip`,target:b.a.createElement("div",{className:A},b.a.createElement("span",{"aria-live":"assertive",className:D},e.validationError),b.a.createElement(B.a,{height:16,width:16,className:q})),position:P.b.BottomRight,tipClassName:L},b.a.createElement(U.a,{text:t,spacing:"tight",className:T}))):b.a.createElement("span",{"aria-live":"assertive",className:D},e.validationError)},H={registrationContainer:"registrationContainer__1DWVArjxkRSHEqpISv3YfU",registrationContainerCompact:"registrationContainerCompact__3f5fD0mXckkhzC_gkXDQaJ",screenReaderOnly:"screenReaderOnly__2S7ruRxpd1VhnuyeMz0di2",submitButton:"submitButton__1syIjVGtZiGfg2aBWCcvkZ",submitButtonCompact:"submitButtonCompact__DTD3_nPUjcDW2juBilPyk",tos:"tos__2S7BNNliayxJrYfZEqHGOH",fieldset:"fieldset__2IcsxborktqVvm5FdfygAO",formCompact:"formCompact__Q6nQtda86q7aKdsfLQSvz",formGroupsCompact:"formGroupsCompact__1e0cWED9TSZNrITxnH3MoV",formGroupCompact:"formGroupCompact__225iYntNRtxkKn05IYqtJ1",inputCompact:"inputCompact__2Shf6uPLKjgQGwlRGM6u4D",validCheckmark:"validCheckmark__FINN8PBxaKyExgp8BuWaN",inputWrapper:"inputWrapper__1WcSn7pm4PiUUt2d3hgszk",hidden:"hidden__IE7yAQczIi7NG5Xaf2XMv",recaptchaError:"recaptchaError__2PRVQPBckCquoqnpNkolaI",formGroup:"formGroup__26lWN6IoN44keRivjjZbD7",padBottomIfNotEmpty:"padBottomIfNotEmpty__SRLk-qQ59lLzCQRc26yql","grecaptcha-badge":"grecaptcha-badge"};function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),i.forEach(function(t){_defineProperty(e,t,a[t])})}return e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const K=[{name:"email",label:I.emailLabel,type:"email",invalidMessage:"Please use a valid email address"},{name:"password",label:I.passwordLabel,type:"password",invalidMessage:"is not long enough",pattern:".{6,128}"}],M="/register/validate",$="/register",Y=e=>{const t=l()(e,"body.errors");return t&&Object.values(t).filter(e=>e)?Object.entries(t).reduce((e,[t,a])=>_objectSpread({},e,{[t]:n()(a)?a[0]:a}),{}):null};class RegistrationForm_RegistrationForm extends f.Component{constructor(...e){super(...e),this.idPrefix="sign_up_form_",this.state={disabled:!1,recaptchaInstanceId:E()(),validationErrors:{},validatedFields:new Set([])},this.onRecapChange=e=>{this.submitForm(e)},this.onRecapExpire=()=>{this.resetRecaptcha()},this.onSuccessfulValidation=e=>{this.setValidationErrorState({[e]:void 0}),this.setState(t=>({validatedFields:t.validatedFields.add(e)}))},this.onFailedValidation=(e,t)=>{this.setValidationErrorState({[e]:t}),this.setState(t=>(t.validatedFields.delete(e),{validatedFields:t.validatedFields}))},this.onSubmissionFailedValidation=e=>{this.setValidationErrorState(e),this.setState(t=>{Object.keys(e).forEach(e=>{t.validatedFields.delete(e)}),this.setState({validatedFields:t.validatedFields})})},this.submitForm=e=>{_.a.post($).send(_objectSpread({},this.serialize(),{"g-recaptcha-response":e})).use(O.b).accept("json").then(({body:e})=>{Object(F.pushDataLayerEvent)("user_sign_up"),this.setState({disabled:!1}),this.props.onSuccess(e)}).catch(e=>{const t=Y(e.response);this.setState({disabled:!1}),t&&this.onSubmissionFailedValidation(t),this.resetRecaptcha()})},this.onSubmitInitialize=e=>(e.preventDefault(),this.isValid()?(this.setState({disabled:!0}),_.a.post(M).send(this.serialize()).use(O.b).accept("json").then(()=>{this.captcha.execute()}).catch(e=>{const t=Y(e.response);t&&(Object.keys(t).forEach(e=>{t[e]=t[e].toLowerCase().replace(e.concat(" "),"")}),this.onSubmissionFailedValidation(t)),this.setState({disabled:!1})})):null),this.genericClientSideValidityHandler=(e,t)=>{const a=t.target.validity.valueMissing,i=t.target.validity.valid;let r;a?r="can't be blank":i||(r=K.find(t=>t.name===e).invalidMessage),r?this.onFailedValidation(e,r):this.onSuccessfulValidation(e)},this.genericServerSideValidityHandler=d()((e,t)=>{t.target.value?_.a.post(M).send({user:{[e]:t.target.value}}).use(O.b).accept("json").then(()=>{this.onSuccessfulValidation(e)}).catch(t=>{const a=Y(t.response);a&&a[e]?this.onFailedValidation(e,a[e]):this.onSuccessfulValidation(e)}):this.onFailedValidation(e,"can't be blank")},250),this.validateField=(e,t)=>{"password"===e?this.genericClientSideValidityHandler(t.target.name,t):this.genericServerSideValidityHandler(t.target.name,t)},this.onFieldBlur=e=>{e.persist();const t=this.serialize().user||{},a=t.email,i=void 0===a?"":a,s=t.password,n=void 0===s?"":s;r()(i)&&r()(n)||this.validateField(e.target.name,e)},this.onFieldKeyUp=e=>{e.persist();const t=e.target.name;this.state.validationErrors[t]&&this.validateField(e.target.name,e)},this.onSubmitClick=()=>{Object(F.trackUserClick)({target:"create_account"})},this.setFormRef=e=>{this.form=e},this.setCaptchaRef=e=>{this.captcha=e}}setValidationErrorState(e,t={}){this.setState(a=>_objectSpread({validationErrors:_objectSpread({},a.validationErrors,e)},t))}isValid(){return!Object.values(this.state.validationErrors).filter(e=>e).length}serialize(){return[...this.form.elements].filter(e=>e.name).reduce((e,t)=>{const a=t.dataset.resource;return _objectSpread({},e,a?{[a]:_objectSpread({},e[a],{[t.name]:t.value})}:{[t.name]:t.value})},{})}resetRecaptcha(){this.setState({recaptchaInstanceId:E()(),disabled:!1})}render(){const e=j.a.get("authenticity_token"),t=this.props,a=t.ctaText,i=t.currentPage,r=t.defaultValues,s=void 0===r?{email:"",password:""}:r,n=t.disableFieldset,o=t.hideOauth,l=t.hideRecaptchaInfo,c=t.hideSubmitButton,d=t.locationType,f=t.markValidatedFields,v=t.redirectUrl,_=t.submitButtonProps,g=t.compact,E=t.classNames,S=void 0===E?{}:E,k=t.isStudent,N="location/EXERCISE"===d,F=this.state.disabled,O=v&&Object(C.f)(v),R=y()("recaptcha-wrapper",{[H.padBottomIfNotEmpty]:g});return b.a.createElement("div",{className:y()(H.registrationContainer,S.container,{[H.registrationContainerCompact]:g})},b.a.createElement("form",{onSubmit:this.onSubmitInitialize,noValidate:!0,ref:this.setFormRef,method:"POST"},b.a.createElement("fieldset",{className:H.fieldset,disabled:n},b.a.createElement("input",{name:"authenticity_token",type:"hidden",value:e}),b.a.createElement("input",{name:"coding_reminders_comms_timezone","data-resource":"user",type:"hidden",value:V.a.tz.guess()}),b.a.createElement("input",{name:"signing_up_from_exercise",type:"hidden",value:`${N}`}),k&&b.a.createElement("input",{name:"student_access",type:"hidden",value:1}),b.a.createElement("input",{name:"referring_page",type:"hidden",value:i}),b.a.createElement("input",{name:"redirect",type:"hidden",value:O}),b.a.createElement("div",{className:y()(H.formGroups,{[H.formGroupsCompact]:g},S.formGroups)},K.map(e=>b.a.createElement(p.a,{key:`${this.idPrefix}${e.name}`,htmlFor:`${this.idPrefix}${e.name}`,label:e.label,className:y()(H.formGroup,{[H.formGroupCompact]:g})},b.a.createElement(Q,{fieldName:e.name,validationError:this.state.validationErrors[e.name]}),b.a.createElement("div",{className:H.inputWrapper},b.a.createElement(m.a,{"aria-invalid":this.state.validationErrors[e.name]?"true":void 0,className:y()(H.input,{[H.inputCompact]:g},S.input),"data-testid":`${e.name}-field`,htmlFor:`${this.idPrefix}${e.name}`,name:e.name,type:e.type,onBlur:this.onFieldBlur,onKeyUp:this.onFieldKeyUp,required:!0,error:!!this.state.validationErrors[e.name],pattern:e.pattern,"data-resource":"user",defaultValue:s[e.name]}),f&&this.state.validatedFields.has(e.name)&&b.a.createElement(u.a,{name:"checkmark",className:H.validCheckmark}))))),b.a.createElement("div",{className:R},this.state.validationErrors.recaptcha&&b.a.createElement("div",{className:H.recaptchaError,"data-testid":"recaptcha-error"},this.state.validationErrors.recaptcha),b.a.createElement(x.a,{key:this.state.recaptchaInstanceId,publicKey:j.a.get("recaptcha_key"),size:"invisible",ref:this.setCaptchaRef,onChange:this.onRecapChange,onExpired:this.onRecapExpire})),b.a.createElement("div",{className:S.footer},b.a.createElement(h.a,_extends({},_,{onClick:this.onSubmitClick,type:"submit",className:y()(H.submitButton,{[H.submitButtonCompact]:g,[H.hidden]:c},S.submitButton),disabled:F,id:`${this.idPrefix}submit`,"data-testid":"registration-form-submit"}),a),!l&&b.a.createElement("p",{className:y()(H.tos,S.tos),dangerouslySetInnerHTML:{__html:I.recaptchaTOS}})))),!o&&b.a.createElement(w.a,{signUp:!0,urlParams:{redirect:O}}))}}RegistrationForm_RegistrationForm.defaultProps={onSuccess:({redirectTo:e,workerSupportApplicant:t})=>{Object(k.g)(e)?window.location.assign(Object(C.f)(e||Object(N.V)())):window.location.assign(Object(C.f)((({redirectUrl:e,workerSupportApplicant:t})=>t?N.Ub:Object(N.tb)({redirectUrl:e,fromSignUpPage:!0}))({redirectUrl:e,workerSupportApplicant:t})))},submitButtonProps:{size:"large",theme:"brand-purple"},ctaText:I.createAccountCTA,isStudent:!1};t.a=RegistrationForm_RegistrationForm}}]);
//# sourceMappingURL=113.094f9d5e887d5e486945.chunk.js.map